紫微排盤方法

1. 將舊版frmPrint2.cs 改成 (Fastapi) Ecanapi 一組或多組方法,以備Flutter 調用
2. 在 frPrint2 第974 起即是原本可成功將客戶資料,出生年月日時,從客戶編號,Flcus 取出 出生年月日時 ,改由Fastapi json input
3. 舊版 frPrint2 從Flcus 取出是農曆,目前 可由  Postgres calander 可直接使用 欄位西元年,月,日  取得農曆年月日時,節氣等必要資料
4. 有了農曆年月日時,節氣等必要資料可開始進入紫微排盤及八字排盤
5. 紫微排盤方法,從frPrint2 2214列起至3372,按原規則執行,目的是依12個陣列儲存各宮位星盤
6. frmPrint2.Print2Excel();執行開啟附件樣版sample.xltx第woksheet(0) ,並依excel A1,b2...將12個陣列套印,其結果為成功範例 的蔡嘉麟先天神數.Xls.worksheet(0) 完成
7. 其中有些若是從 sql 資料庫的資料表,需將mssql 轉成 sql 新增至 postgres



製作匯總古命學研究作成一套AI專業RAG命學分析系統計劃書,及執行計劃,一步一步完成後,系統開發及佈署雲端
製作工具,前端採Flutter ,後端以 asp.net c# api, 目前已有 fastapi及完成建立客戶資料 
在現在架構下,新增匯入個人命盤,建立RAG(我有研究紫微及八字多年的心得及文件,DOC,PDF等) 及LLM,分析後提出建議書
分析流程方法

1. 匯入現有由出生年月日時的實際 excel (範例蔡嘉麟先天神數.Xls,有前8個worksheet 需要將每個cell 資料取出
2. 依每個worksheet name 建立表格 寫入 資料庫 postgres 用出生年月日時(worksheet('先天元神圖').h36)及姓名(worksheet('先天元神圖').h36)當成index key 索引,建立8張 insert to  worksheet name table
3. 第一步 分析 先天元神圖紫微斗數結構如下
   (每個星是以一字表示) 每個官位都是以excel 固定位置及相對位置,上橫有四格,下有四格,中有二格如下圖
   +----+----+----+----+
   |    |    |    |    |
   |    |    |    |    |
   +----+----+----+----+
   |    |         |    |
   |    |         |    |
   +----+         +----+
   |    |         |    |
   |    |         |    |
   +----+----+----+----+
   |    |    |    |    |
   |    |    |    |    |
   +----+----+----+----+
   3.1 第一張worksheet  共用二大結構 (紫微斗數 )
   A7,B7  大運起,大運訖 C7 是十二宮  D7 紫微主星一,E7紫微主星二
   A8,B8,C8  副星一,副星二,副星三
   D9,E9  主星亮度,宮位喜忌(亮度(0-2及宮位喜忌-+!*)
   A10    小星群(一字表示一星,要分解出) D10主星年干四化 E10主星年干四化
   A15    宮干四化流星-(星化入十二宮位(4個字)+空格+流年星曜+歲星+空格+十二長生)
   A16    地支方位
   
4. 第二步 分析 先天元神圖八字結構如下
   (每個星是以一字表示) 每個官位都是以excel 固定位置及相對位置,在中間共有 四格,每四格取法,如下圖
   +----+----+----+----+
   |    |    |    |    |
   |G19 |    | K19|M19 | 
   +----+----+----+----+
   |G20 |I20 | K20| M20|
   |    |    |    |    |
   +----+----+----+----+
   |G25 |I25 | K25| M25|
   |    |    |    |    |
   +----+----+----+----+
   |G28 |I28 | K28| M28|
   |    |    |    |    |
   +----+----+----+----+
   |G29 |I29 | K29| M29|
   |H29 |J29 | L29| N29|
   +----+----+----+----+
   |G30 |I30 | K30| M30|
   |H30 |J30 | L30| N30|
   |    |    |    |    |
   +----+----+----+----+
   |G31 |I31 | K31| M31|
   |H31 |J31 | L31| N31| 
   +----+----+----+----+
  
   4.1 第一張worksheet  (子平八字)
   G19,時干六神,K19,月干六神,M19,年干六神
   G20,時天干,I20,日天干,K20,月天干,M20,年天干
   G25,時地支,I25,日地支,K25,月地支,M25,年地支
   G28,時納音,I28,日納音,K28,月納音,M28,年納音
   G29,時地支六神,I29,日地支六神,K29,月地支六神,M29,年地支六神
   G30,時地支六神二,I30,日地支六神二,K30,月地支六神二,M30,年地支六神二
   G31,時地支六神三,I31,日地支六神三,K31,月地支六神三,M31,年地支六神三   
   
5. 第三步 將第一步及第二步解析的資料, 寫入表格public.先天元神圖
   public.先天元神圖.出生日時=worksheet('先天元神圖').M36
   public.先天元神圖.姓名=worksheet('先天元神圖').H36
   public.先天元神圖.中文欄名=worksheet.cell(第一步及第二步解析位置).value轉成文字
   
6. 依先天元神圖中紫微主星及副星及四化分析 命中十二宮分析個性,財運,官運,夫妻,子女,健康,職業等參考RAG 及LLM 分析,製作個人先天綱要建議書
7. 依先天元神圖中紫微大運及宮位四化分析   大運中十二宮分析個性,財運,官運,夫妻,子女,健康,職業等參考RAG 及LLM 分析 ,製作個人大運分析及建議書
8. 依先天元神圖中紫微流年及流年四化分析   流年中十二宮分析個性,財運,官運,夫妻,子女,健康,職業等參考RAG 及LLM 分析 ,製作個人流年分析及建議書
  
